ARCH?=ARM
CORTEX_M4?=1
TARGET?=va416x0

# ECDSA P384 and SHA384
SIGN?=ECC384
HASH?=SHA384
IMAGE_HEADER_SIZE=512

# ML-DSA Level 5 (87)
#SIGN=ML_DSA
#HASH=SHA256
#ML_DSA_LEVEL=5
#IMAGE_SIGNATURE_SIZE=4627
#IMAGE_HEADER_SIZE=12288

WOLFBOOT_VERSION?=1
ARMORED?=1
DEBUG?=0
DEBUG_SYMBOLS?=1
DEBUG_UART?=1
VTOR?=1
EXT_FLASH?=1
SPI_FLASH?=0
NO_XIP?=1
NVM_FLASH_WRITEONCE?=0
UART_FLASH?=0
V?=0
NO_MPU?=1
RAM_CODE?=0
SPMATH?=1
DUALBANK_SWAP?=0
PKA?=0
ENCRYPT=0
WOLFTPM?=0
OPTIMIZATION_LEVEL=s

# Optionally allow downgrade to older valid version in update partition
ALLOW_DOWNGRADE?=0

# Use assembly version of ECDSA and SHA
NO_ASM?=0
NO_ARM_ASM?=0

# Optional: Use smaller SHA512
#CFLAGS_EXTRA+=-DUSE_SLOW_SHA512

# Optimized: 46KB wolfboot, 104KB partitions, 2KB swap
WOLFBOOT_SECTOR_SIZE?=0x800
WOLFBOOT_PARTITION_SIZE?=0x1A000
WOLFBOOT_PARTITION_BOOT_ADDRESS?=0xB800
WOLFBOOT_PARTITION_UPDATE_ADDRESS?=0x25800
WOLFBOOT_PARTITION_SWAP_ADDRESS?=0x3F800

# ML-DSA 5: 36KB boot, 96KB partitions, 12KB swap
#WOLFBOOT_SECTOR_SIZE?=0x3000
#WOLFBOOT_PARTITION_SIZE?=0x18000
#WOLFBOOT_PARTITION_BOOT_ADDRESS?=0x9000
#WOLFBOOT_PARTITION_UPDATE_ADDRESS?=0x21000
#WOLFBOOT_PARTITION_SWAP_ADDRESS?=0x3D000

# Debug: 64KB boot, 94KB partitions, 2KB swap
#WOLFBOOT_SECTOR_SIZE?=0x800
#WOLFBOOT_PARTITION_SIZE?=0x17800
#WOLFBOOT_PARTITION_BOOT_ADDRESS?=0x10000
#WOLFBOOT_PARTITION_UPDATE_ADDRESS?=0x27800
#WOLFBOOT_PARTITION_SWAP_ADDRESS?=0x3F000

# Vorago SDK common drivers directory
VORAGO_SDK_DIR?=$(PWD)/../VA416xx_SDK/

# Use Vorago FRAM driver
USE_HAL_SPI_FRAM=1

#CFLAGS_EXTRA+=-DWOLFBOOT_EDAC_RAM_SCRUB=1000
#CFLAGS_EXTRA+=-DWOLFBOOT_EDAC_ROM_SCRUB=125

# Restore clock to heart-beat oscillator (set to 0 to leave clock at 100MHz)
WOLFBOOT_RESTORE_CLOCK?=1

# Optional debugging
#CFLAGS_EXTRA+=-DDEBUG_EXT_FLASH
#CFLAGS_EXTRA+=-DTEST_EXT_FLASH

# Optional: Enable wolfCrypt test and benchmark in test-app
# Uncomment to enable
# Note: Requires ~80-160KB additional flash and ~10-20KB RAM
#WOLFCRYPT_TEST?=1
#WOLFCRYPT_BENCHMARK?=1
